<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
        <title>robap/php-router @ GitHub</title>
        <link href="prettify/prettify.css" type="text/css" rel="stylesheet" />
        <script type="text/javascript" src="prettify/prettify.js"></script>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
        <script type="text/javascript">
          $(document).ready(function() {
            $('pre').addClass('prettyprint')
            prettyPrint()
          });
        </script>
        <style type="text/css">
            body {
                margin-top: 1.0em;
                background-color: #fff;
                font-family: "helvetica";
                color: #555;
            }
            #container {
                margin: 0 auto;
                width: 700px;
            }
            h1 { font-size: 3.8em; color: #db7c1f; margin-bottom: 3px; }
            h1 .small { font-size: 0.4em; }
            h1 a { text-decoration: none }
            h2 { font-size: 1.5em; color: #db7c1f; }
            h3 { text-align: center; color: #db7c1f; }
            a { color: #db7c1f; }
            .description { font-size: 1.2em; margin-bottom: 30px; margin-top: 30px; font-style: italic;}
            .download { float: right; }
            pre { background: #e0e0e0; color: #000; padding: 15px;}
            hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
            .footer { text-align:center; padding-top:30px; font-style: italic; }
        </style>
    </head>
    <body>
    <a href="http://github.com/robap/php-router">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" />
    </a>

    <div id="container">
        <div class="download">
            <a href="http://github.com/robap/php-router/zipball/master">
                <img border="0" width="90" src="http://github.com/images/modules/download/zip.png">
            </a>
            <a href="http://github.com/robap/php-router/tarball/master">
                <img border="0" width="90" src="http://github.com/images/modules/download/tar.png">
            </a>
        </div>
        <h1>
            <a href="http://github.com/robap/php-router">php-router</a>
            <span class="small">by <a href="http://github.com/robap">robap</a></span>
        </h1>
        <div class="description">
            a php routing class
        </div>

        <p>
            The php router class is designed to help you with php routing by mapping
            so called &quot;pretty&quot; url&rsquo;s to class::methods that reside in your
            framework. It is not in itself a framework. To use it, you will need
            to create a index/bootstrap file and configure apache to route requests
            there. Included is a sample.htaccess file which you can copy into your
            apache public directory along with your index/bootstrap file.
        </p>
        <h2>Dependencies</h2>
        <p><a href="http://www.php.net/">&gt;= php 5.2.x</a></p>
        <h2>Install</h2>
        <ol>
            <li>
                Copy Router.php to some place accessible by your framework and include it.
            </li>
            <li>
                Create your index.php file and Tell apache to route requests
                through index.php (see sample.htaccess).
            </li>
            <li>
                Set your controllers path.
            </li>
            <li>
                Create your routes for your controller/actions (see the 'Adding Routes'
                section below).
            </li>
            <li>
                Call Router::matchMap(); at the end of
                your index.php file.
            </li>
        </ol>
        <h2>Explanation of how routing behaves</h2>
        <p>
            The route path is a string specified with no preceding slash and can contain
            static and dynamic elements. Dynamic elements are defined with ":" + name
            (':dynamic'). They must have corresponding array keys in the args array. The
            dynamic args are where you specify what type of strings will match.
        </p>
        <p>So, given the following url:</p>
        
        <pre>"/foo/bar/908"</pre>

        <p>And a mapping:</p>
        
<pre>&lt;?php
array('/foo/bar/:id' => array (
    'controller' => 'foo',
    'action'     => 'bar',
    'args'       => array(':id' => NULL)
));
?&gt;</pre>
        
        <p>
            the following will be executed:
        </p>
        <pre>foo::bar( array(':id' => 908) )</pre>
        <p>
            Notice that the controller::method is passed an array as the argument.
            Your controller classes should be written to accept this array.
        </p>

        <h2>Dynamic elements</h2>
        <p>
            Dynamic element values can be either NULL, which will match anything or a string
            which represents a regular expression. The regular expression is evaluated using
            php's preg_match function. So any valid regex will work. Some common regex's:
        <br /><br />
            '/^\d+$/'    : must be a number<br />
            '/^\d{4}$/'  : must be a 4 digit number<br />
            '/^abc\d+$/' : must be a string begining with 'abc' and ending in numbers<br />

        <h2>Adding routes</h2>
        <p>
            You can add routes all at once by using the Router::autoLoadRoutes method.
        </p>
        <p>Example:</p>
        <pre>Router::autoLoadRoutes('/path/to/my/routes/file')</pre>
        <p>
            The other method of adding routes is to use the Router::addRoute method. For
            example:
        </p>
        
<pre>try {
    Router::addRoute('/my/path/:year/:id', array (
        'controller' => 'controllerclass',
        'action' => 'controllerMethod',
        'args' => array(':year' => '/^\d{4}$/', ':id' => '/^\d+$/')
    );
    Router::addRoute('/my/other/path/:id', array (
        'controller' => 'controllerClass',
        'action' => 'controllerMethod',
        'args' => array(':id' => NULL)
    );
    //etc
} catch (Exception $e) {
    echo $e->getMessage();
}</pre>
        
        <p>
            Note that the Router::addRoute() throws an Exception if the 'controller', 'action'
            and 'args' keys are not present in the second argument. Even if you are creating
            a static map with no dynamic elements, the args key must contain an empty array.
        </p>
        <p>
        The 'args' array must contain keys which correspond to the dynamic elements of
        the path.
        </p>
        <h2>Sample routes.php</h2>
        <p>
            The routes file (if you use one) must contain an array stored in a variable
            named "$routes" and should be in the format:
        </p>
        
<pre>&lt;?php
$routes = array (
    'foo/bar/:id' => array (
        'controller' => 'foo',
        'action'     => 'bar',
        //This map will match id's that contain numbers only
        'args'       => array(':id' => '/^\d+$/')
    ),
    //You may define a catch all map. It should go last in the array.
    ':controller/:action/:id' => array (
        'controller' => ':controller',
        'action'     => ':action',
        'args'       => array(':controller' => NULL, ':action' => NULL, ':id' => NULL)
    )
);
?&gt;</pre>
        
        <h2>Basic index.php Example</h2>
        
<pre>&lt;?php
include('Router.php');

Router::setControllersPath('/path/to/controllers', '.php');

try {
    Router::addRoute(':controller/:action/:id', array (
        'controller' => ':controller',
        'action'     => ':action',
        'args'       => array(':controller' => NULL, ':action' => NULL, ':id' => NULL)
    ));
} catch (Exception $e) {
    echo $e;
}

Router::matchMap($_SERVER['REQUEST_URI']);
?&gt;</pre>
        
        
        <h2>Example index.php using routes.php file</h2>
        
<pre>&lt;?php
include('Router.php');

Router::setControllersPath('/path/to/controllers', '.php');

//Specify the location of the routes.php file
Router::autoLoadRoutes( '/path/to/your/routes.php' );

Router::matchMap($_SERVER['REQUEST_URI']);
?&gt;</pre>
        
        <h2>The default dispatcher</h2>
        <p>
            The default dispatcher will call your controller::action statically. If you
            want different behavior (such as creating an instance of the controller), define
            your own dispatcher and set it using the Router::setDispatcher method described
            below.
        </p>

        <h2>Defining your own dispatcher</h2>
        <p>
            By default, the Router::dispatch method is called by Router::matchMap whenever
            a match is found. You can define your own dispatch class and tell the Router
            class to use that class or an instance of that class instead.
        </p>
        <p>
            For example:
        </p>
        
<pre>&lt;?php
class customDispatcher
{
    /**
    * string $controller
    * string $action
    * array $args
    */
    public function dispatch( $controller, $action, $args )
    {
        //Your own code to dispatch the request

        //The dispatch method MUST return TRUE if the controller::method was
        // found, FALSE if not found.
        return TRUE;
    }
}

Router::setControllersPath('/path/to/controllers');
Router::autoLoadRoutes( '/path/to/your/routes.php' );

//You can use the class statically...
Router::setDispatcher( 'customDispatcher', 'dispatch' );

//OR use an instance of the class:
$custom_dispatcher = new customDispatcher();
Router::setDispatcher( $custom_dispatcher, 'dispatch' );

Router::matchMap($_SERVER['REQUEST_URI']);
?&gt;</pre>
        

        <p>
            VERY IMPORTANT! When creating your own dispatcher, make sure you
            take proper steps to secure the code and not allow arbitrary files
            to be required in. Any dynamic elements matched will be passed to
            your custom dispatcher from the wild unaltered.
        </p>

        <h2>Debugging</h2>

        <p>The method getErrors() is provided to help debug routing errors:</p>

        
<pre>print_r( Router::getErrors() );</pre>
       

        <h2>License</h2>
        <p>
            <a href="http://www.gnu.org/licenses/gpl.txt">GNU General Public License</a>
        </p>
        <h2>Authors</h2>
        <p>Rob Apodaca (rob.apodaca@gmail.com)
        </p>
        <h2>Contact</h2>
        <p>Rob Apodaca (rob.apodaca@gmail.com)</p>

        <h2>Download</h2>
        <p>
            You can download this project in either
            <a href="http://github.com/robap/php-router/zipball/master">zip</a>
            or
            <a href="http://github.com/robap/php-router/tarball/master">tar</a>
            formats.
        </p>
        <p>
            You can also clone the project with <a href="http://git-scm.com">Git</a>
            by running:
        <pre>$ git clone git://github.com/robap/php-router</pre>
    </p>
    <div class="footer">
        get the source code on GitHub : <a href="http://github.com/robap/php-router">robap/php-router</a>
    </div>
</div>
    <script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-9779785-1");
pageTracker._trackPageview();
} catch(err) {}</script>
</body>
</html>
